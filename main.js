const quizData = {
  questions: [
    {
      text: '미술관에서는 조용히 해야 한다',
      options: [
        // 긍정 (좋은 부분)
        { text: '여유롭다', value: 'S1' },
        { text: '고요하다', value: 'S2' },
        { text: '편안하다', value: 'S3' },
        { text: '차분하다', value: 'S4' },
        { text: '평온하다', value: 'S5' },
        { text: '안정적이다', value: 'S6' },
        { text: '숙연하다', value: 'S7' },
        { text: '집중된다', value: 'S8' },
        { text: '잔잔해진다', value: 'S9' },
        { text: '힐링된다', value: 'S10' },
        { text: '포근하다', value: 'S11' },
        { text: '평화롭다', value: 'S12' },
        { text: '담담하다', value: 'S13' },
        { text: '침착하다', value: 'S14' },
        { text: '자연스럽다', value: 'S15' },
        // 부정 (불편한 부분)
        { text: '위축된다', value: 'S16' },
        { text: '숨막힌다', value: 'S17' },
        { text: '답답하다', value: 'S18' },
        { text: '갑갑하다', value: 'S19' },
        { text: '불편하다', value: 'S20' },
        { text: '짜증난다', value: 'S21' },
        { text: '부담된다', value: 'S22' },
        { text: '긴장된다', value: 'S23' },
        { text: '어색하다', value: 'S24' },
        { text: '우울하다', value: 'S25' },
        { text: '지루하다', value: 'S26' },
        { text: '딱딱하다', value: 'S27' },
        { text: '무겁다', value: 'S28' },
        { text: '억울하다', value: 'S29' },
        { text: '압박감이 든다', value: 'S30' },
      ],
    },
    {
      text: '미술관에서는 뛰면 안된다',
      options: [
        // 긍정 (규칙에 대한 좋은 느낌)
        { text: '안전하다', value: 'R1' },
        { text: '차분하다', value: 'R2' },
        { text: '여유롭다', value: 'R3' },
        { text: '편안하다', value: 'R4' },
        { text: '당연하다', value: 'R5' },
        { text: '안정적이다', value: 'R6' },
        { text: '신중하다', value: 'R7' },
        { text: '침착하다', value: 'R8' },
        { text: '느긋하다', value: 'R9' },
        { text: '담담하다', value: 'R10' },
        { text: '평온하다', value: 'R11' },
        { text: '포근하다', value: 'R12' },
        { text: '자연스럽다', value: 'R13' },
        { text: '좋다', value: 'R14' },
        { text: '이해된다', value: 'R15' },
        // 부정 (규칙에 대한 불편한 느낌)
        { text: '답답하다', value: 'R16' },
        { text: '갑갑하다', value: 'R17' },
        { text: '불편하다', value: 'R18' },
        { text: '제한적이다', value: 'R19' },
        { text: '짜증난다', value: 'R20' },
        { text: '지루하다', value: 'R21' },
        { text: '부담된다', value: 'R22' },
        { text: '위축된다', value: 'R23' },
        { text: '억울하다', value: 'R24' },
        { text: '딱딱하다', value: 'R25' },
        { text: '심심하다', value: 'R26' },
        { text: '재미없다', value: 'R27' },
        { text: '긴장된다', value: 'R28' },
        { text: '어색하다', value: 'R29' },
        { text: '따분하다', value: 'R30' },
      ],
    },
    {
      text: '미술관 전시실에는 음식물 반입이 금지되어 있다.',
      options: [
        // ① 긍정적 형용사
        { text: '위생적이다', value: 'F1' },
        { text: '청결하다', value: 'F2' },
        { text: '쾌적하다', value: 'F3' },
        { text: '안전하다', value: 'F4' },
        { text: '질서 있다', value: 'F5' },
        { text: '전문적이다', value: 'F6' },
        { text: '보호적이다', value: 'F7' },
        { text: '책임감 있다', value: 'F8' },
        { text: '신중하다', value: 'F9' },
        { text: '엄격하다', value: 'F10' },
        { text: '집중하기 좋다', value: 'F11' },
        { text: '차분하다', value: 'F12' },
        { text: '안정적이다', value: 'F13' },
        { text: '정돈되어 있다', value: 'F14' },
        { text: '공공성을 지킨다', value: 'F15' },
        // ② 부정적 형용사
        { text: '불편하다', value: 'F16' },
        { text: '답답하다', value: 'F17' },
        { text: '제한적이다', value: 'F18' },
        { text: '부담스럽다', value: 'F19' },
        { text: '슬프다', value: 'F20' },
        { text: '폐쇄적이다', value: 'F21' },
        { text: '위압적이다', value: 'F22' },
        { text: '딱딱하다', value: 'F23' },
        { text: '거리감이 있다', value: 'F24' },
        { text: '자유롭지 못하다', value: 'F25' },
        // ③ 중립적·양가적 표현
        { text: '통제되어 있다', value: 'F26' },
        { text: '관리된다', value: 'F27' },
        { text: '규범적이다', value: 'F28' },
        { text: '배고프다', value: 'F29' },
        { text: '공식적이다', value: 'F30' },
      ],
    },
    {
      text: '다른사람이 내가 원하는 작품을 보고 있다. 이때 나의 감정은?',
      options: [
        { text: '아쉽다', value: 'V1' },
        { text: '속상하다', value: 'V2' },
        { text: '답답하다', value: 'V3' },
        { text: '조급하다', value: 'V4' },
        { text: '초조하다', value: 'V5' },
        { text: '불편하다', value: 'V6' },
        { text: '짜증이 나다', value: 'V7' },
        { text: '질투하다', value: 'V8' },
        { text: '의식하다', value: 'V9' },
        { text: '예민해지다', value: 'V10' },
        { text: '이해하다', value: 'V11' },
        { text: '참다', value: 'V12' },
        { text: '양보하다', value: 'V13' },
        { text: '수용하다', value: 'V14' },
        { text: '욕심이 나다', value: 'V15' },
        { text: '불안하다', value: 'V16' },
        { text: '관대해지다', value: 'V17' },
        { text: '눈치가 보이다', value: 'V18' },
        { text: '억울하다', value: 'V19' },
        { text: '조심스럽다', value: 'V20' },
        { text: '긴장하다', value: 'V21' },
        { text: '침착해지다', value: 'V22' },
        { text: '괜찮다', value: 'V23' },
        { text: '편하다', value: 'V24' },
        { text: '자연스럽다', value: 'V25' },
        { text: '여유롭다', value: 'V26' },
        { text: '당연하다', value: 'V27' },
        { text: '반갑다', value: 'V28' },
        { text: '공감하다', value: 'V29' },
        { text: '안절부절하다', value: 'V30' },
      ],
    },
    {
      text: '작품을 이해하려고 노력할 때 나의 감정은?',
      options: [
        { text: '궁금하다', value: 'W1' },
        { text: '집중하다', value: 'W2' },
        { text: '몰입하다', value: 'W3' },
        { text: '신중하다', value: 'W4' },
        { text: '조심스럽다', value: 'W5' },
        { text: '낯설다', value: 'W6' },
        { text: '어렵다', value: 'W7' },
        { text: '답답하다', value: 'W8' },
        { text: '혼란스럽다', value: 'W9' },
        { text: '막막하다', value: 'W10' },
        { text: '흥미롭다', value: 'W11' },
        { text: '재미있다', value: 'W12' },
        { text: '도전적이다', value: 'W13' },
        { text: '의욕이 생기다', value: 'W14' },
        { text: '끈기 있다', value: 'W15' },
        { text: '집요하다', value: 'W16' },
        { text: '세심하다', value: 'W17' },
        { text: '예민해지다', value: 'W18' },
        { text: '스트레스 받다', value: 'W19' },
        { text: '거리감이 느껴지다', value: 'W20' },
        { text: '새롭다', value: 'W21' },
        { text: '통찰하다', value: 'W22' },
        { text: '깨닫다', value: 'W23' },
        { text: '뿌듯하다', value: 'W24' },
        { text: '성취감을 느끼다', value: 'W25' },
        { text: '성찰하다', value: 'W26' },
        { text: '긴장하다', value: 'W27' },
        { text: '설레다', value: 'W28' },
        { text: '호기심이 생기다', value: 'W29' },
        { text: '만족스럽다', value: 'W30' },
      ],
    },
    {
      text: '미술관에 갈 때 어떤 옷을 입을지 고민될 때 나의 감정은?',
      options: [
        { text: '고민되다', value: 'X1' },
        { text: '망설여지다', value: 'X2' },
        { text: '신경이 쓰이다', value: 'X3' },
        { text: '의식하다', value: 'X4' },
        { text: '설레다', value: 'X5' },
        { text: '기대되다', value: 'X6' },
        { text: '긴장하다', value: 'X7' },
        { text: '부담스럽다', value: 'X8' },
        { text: '조심스럽다', value: 'X9' },
        { text: '걱정되다', value: 'X10' },
        { text: '불안하다', value: 'X11' },
        { text: '자신 없다', value: 'X12' },
        { text: '잘 보이고 싶다', value: 'X13' },
        { text: '튀고 싶지 않다', value: 'X14' },
        { text: '행복하다', value: 'X15' },
        { text: '격식을 차리고 싶다', value: 'X16' },
        { text: '편하게 입고 싶다', value: 'X17' },
        { text: '눈치가 보이다', value: 'X18' },
        { text: '위축되다', value: 'X19' },
        { text: '들뜨다', value: 'X20' },
        { text: '기분이 좋아지다', value: 'X21' },
        { text: '어색하다', value: 'X22' },
        { text: '스트레스 받다', value: 'X23' },
        { text: '답답하다', value: 'X24' },
        { text: '괜찮다', value: 'X25' },
        { text: '자연스럽다', value: 'X26' },
        { text: '부담된다', value: 'X27' },
        { text: '막막하다', value: 'X28' },
        { text: '편안하다', value: 'X29' },
        { text: '당당해지다', value: 'X30' },
      ],
    },
  ],
  exhibition: {
    '1전시실': ['A', 'B', 'C', 'D', 'E'],
    '2전시실': ['F', 'G', 'H', 'I', 'J'],
    '3전시실': ['K', 'L', 'M', 'N', 'O'],
  },
  workLabels: {
    A: '김지은, <부동산적 풍경화 #2>',
    B: '정세인, <Only.Love.gr.pu>',
    C: '김정우, <빨간내복 20097>',
    D: '박소라, <에너지 드링크가 필요한 사회>',
    E: '김승주, <Ruler No. 0>',
    F: '신미경, <Angel Series 58>',
    G: '최병석, <숲속 생활연구소>',
    H: '홍승표, <CPR Board B>',
    I: '오유경, <맺고 있는 얽힘 상태>',
    J: '권순관, <Gestures in the Subway 3-39>',
    K: '김우진, <유령과 바다, 그리고 뫼비우스>',
    L: '정성진, <Moving City>',
    M: '문소현, <Hollow Show-Night Life>',
    N: '장서영, <터뷸런스>',
    O: '더 브이오에이, <불판에 남은 떡볶이 떡의 마음속에서는 불가능한 물리적인 죽음>',
  },
  workQuestions: [
    { key: 'farPrep', text: '{work}에서 다섯 걸음 물러나, 작품의 전체 분위기를 느껴보세요.', usePrep: true },
    { key: 'far', text: '작품 {work}를 멀리서 볼 때', optionsKey: 'far', useSliders: true },
    { key: 'nearPrep', text: '{work} 앞으로 다섯 걸음 다가가, 작품을 천천히 들여다보세요.', usePrep: true },
    { key: 'near', text: '작품 {work}를 가까이서 볼 때', optionsKey: 'near', useSliders: true },
    { key: 'captionPrep', text: '작품 {work} 옆 캡션을 읽어주세요.', usePrep: true },
    { key: 'captionEmotion', text: '설명을 본 후 작품을 봤을 때 어떤 감정이 드나요?', optionsKey: 'captionEmotion' },
    { key: 'emotion', text: '작품 {work}를 보고 느끼는 감정', optionsKey: 'emotion' },
  ],
  // 작품별 슬라이더 (멀리서/가까이서 동일)
  workSliders: {
    A: [ // 김지은
      { left: '편안함', right: '답답함', defaultVal: 50 },
      { left: '차분함', right: '혼란스러움', defaultVal: 50 },
      { left: '이상적', right: '현실적', defaultVal: 50 },
    ],
    B: [ // 정세인
      { left: '공개적인', right: '감춰진', defaultVal: 50 },
      { left: '감성적', right: '이성적', defaultVal: 50 },
      { left: '해방감', right: '압박감', defaultVal: 50 },
    ],
    C: [ // 김정우
      { left: '밝음', right: '어두움', defaultVal: 50 },
      { left: '해맑음', right: '처량함', defaultVal: 50 },
      { left: '안전한', right: '위험한', defaultVal: 50 },
    ],
    D: [ // 박소라
      { left: '가벼움', right: '무거움', defaultVal: 50 },
      { left: '편안함', right: '답답함', defaultVal: 50 },
      { left: '재밌음', right: '진중함', defaultVal: 50 },
    ],
    E: [ // 김승주
      { left: '재밌음', right: '혼란스러움', defaultVal: 50 },
      { left: '독창적임', right: '익숙함', defaultVal: 50 },
      { left: '자유로운', right: '정해진', defaultVal: 50 },
    ],
    F: [ // 신미경
      { left: '부드러움', right: '단단함', defaultVal: 50 },
      { left: '수줍음', right: '거만함', defaultVal: 50 },
      { left: '웅장함', right: '소박함', defaultVal: 50 },
    ],
    G: [ // 최병석
      { left: '쓸모', right: '무쓸모', defaultVal: 50 },
      { left: '과학자', right: '괴짜', defaultVal: 50 },
      { left: '재밌음', right: '불편함', defaultVal: 50 },
    ],
    H: [ // 홍승표
      { left: '안전한', right: '위험한', defaultVal: 50 },
      { left: '흰 글씨', right: '빨간 글씨', defaultVal: 50 },
      { left: '재밌음', right: '불편함', defaultVal: 50 },
    ],
    I: [ // 오유경
      { left: '복잡한', right: '단순한', defaultVal: 50 },
      { left: '곡선', right: '직선', defaultVal: 50 },
      { left: '편안한', right: '긴장한', defaultVal: 50 },
    ],
    J: [ // 권순관
      { left: '자유로운', right: '감시받는', defaultVal: 50 },
      { left: '소속감', right: '고립감', defaultVal: 50 },
      { left: '개인적', right: '집단적', defaultVal: 50 },
    ],
    K: [ // 김우진
      { left: '슬픔', right: '무서움', defaultVal: 50 },
      { left: '고요함', right: '불안함', defaultVal: 50 },
      { left: '공허한', right: '의미 있는', defaultVal: 50 },
    ],
    L: [ // 정성진
      { left: '평온한', right: '어지러운', defaultVal: 50 },
      { left: '재밌는', right: '무서운', defaultVal: 50 },
      { left: '생명', right: '죽음', defaultVal: 50 },
    ],
    M: [ // 문소현
      { left: '찬란한', right: '공허한', defaultVal: 50 },
      { left: '천국', right: '지옥', defaultVal: 50 },
      { left: '빛', right: '어둠', defaultVal: 50 },
    ],
    N: [ // 장서영
      { left: '편안한', right: '갑갑한', defaultVal: 50 },
      { left: '밀착된', right: '분리된', defaultVal: 50 },
      { left: '자유로운', right: '단절된', defaultVal: 50 },
    ],
    O: [ // 더 브이오에이
      { left: '귀여움', right: '무서움', defaultVal: 50 },
      { left: '재밌는', right: '난해한', defaultVal: 50 },
      { left: '떡볶이', right: '작품', defaultVal: 50 },
    ],
  },
  workOptions: {
    far: [
      { text: '아련하다', value: 'FA1' }, { text: '멀다', value: 'FA2' }, { text: '선명하다', value: 'FA3' },
      { text: '흐릿하다', value: 'FA4' }, { text: '평온하다', value: 'FA5' }, { text: '궁금하다', value: 'FA6' },
      { text: '당당하다', value: 'FA7' }, { text: '조용하다', value: 'FA8' }, { text: '위엄있다', value: 'FA9' },
      { text: '신비롭다', value: 'FA10' }, { text: '답답하다', value: 'FA11' }, { text: '편안하다', value: 'FA12' },
      { text: '외롭다', value: 'FA13' }, { text: '모호하다', value: 'FA14' }, { text: '강렬하다', value: 'FA15' },
      { text: '부드럽다', value: 'FA16' }, { text: '차갑다', value: 'FA17' }, { text: '따뜻하다', value: 'FA18' },
      { text: '낯설다', value: 'FA19' }, { text: '친숙하다', value: 'FA20' },
    ],
    near: [
      { text: '압도된다', value: 'CA1' }, { text: '선명하다', value: 'CA2' }, { text: '가깝다', value: 'CA3' },
      { text: '섬뜩하다', value: 'CA4' }, { text: '친근하다', value: 'CA5' }, { text: '긴장된다', value: 'CA6' },
      { text: '설렌다', value: 'CA7' }, { text: '두렵다', value: 'CA8' }, { text: '감동한다', value: 'CA9' },
      { text: '호기심', value: 'CA10' }, { text: '답답하다', value: 'CA11' }, { text: '편안하다', value: 'CA12' },
      { text: '신비롭다', value: 'CA13' }, { text: '당당하다', value: 'CA14' }, { text: '강렬하다', value: 'CA15' },
      { text: '부드럽다', value: 'CA16' }, { text: '섬세하다', value: 'CA17' }, { text: '거대하다', value: 'CA18' },
      { text: '작다', value: 'CA19' }, { text: '압박감', value: 'CA20' },
    ],
    emotion: [
      { text: '😊', value: 'EM1' },
      { text: '😍', value: 'EM2' },
      { text: '🤩', value: 'EM3' },
      { text: '🧐', value: 'EM4' },
      { text: '😎', value: 'EM5' },
      { text: '😢', value: 'EM6' },
      { text: '🫨', value: 'EM7' },
      { text: '😴', value: 'EM8' },
      { text: '😵‍💫', value: 'EM9' },
      { text: '🤔', value: 'EM10' },
    ],
    captionEmotion: [
      { text: '이해된다', value: 'CP1' },
      { text: '분석적이다', value: 'CP2' },
      { text: '비판적이다', value: 'CP3' },
      { text: '긴장되다', value: 'CP4' },
      { text: '의미 있다', value: 'CP5' },
      { text: '선명하다', value: 'CP6' },
      { text: '차분하다', value: 'CP7' },
      { text: '객관적이다', value: 'CP8' },
      { text: '이성적이다', value: 'CP9' },
      { text: '정리된다', value: 'CP10' },
      { text: '논리적이다', value: 'CP11' },
      { text: '냉정하다', value: 'CP12' },
      { text: '집중된다', value: 'CP13' },
      { text: '분명하다', value: 'CP14' },
      { text: '또렷하다', value: 'CP15' },
      { text: '구조적이다', value: 'CP16' },
      { text: '거리감 있다', value: 'CP17' },
      { text: '담담하다', value: 'CP18' },
      { text: '정돈되다', value: 'CP19' },
      { text: '명확하다', value: 'CP20' },
      { text: '흥미롭다', value: 'CP21' },
      { text: '관찰적이다', value: 'CP22' },
      { text: '재미있다', value: 'CP23' },
      { text: '조용하다', value: 'CP24' },
      { text: '진지하다', value: 'CP25' },
      { text: '생각하다', value: 'CP26' },
      { text: '압박감 들다', value: 'CP27' },
      { text: '어렵다', value: 'CP28' },
      { text: '스트레스 받다', value: 'CP29' },
      { text: '눈치보다', value: 'CP30' },
    ],
  },
  // 모드별 질문 (선택 사항). 예: questionsByMode: { '남': [...], '어린이': [...] }
  // 없으면 기본 questions 사용
  questionsByMode: {},
  results: {
    A: { type: '답답함', description: '미술관의 조용한 분위기가 답답하게 느껴지는군요. 열린 공간과 자유로움이 더 맞을 수 있어요.' },
    B: { type: '편안함', description: '미술관의 조용한 분위기가 편안하게 느껴지시는군요. 차분한 감상이 잘 맞는 타입이에요.' },
    C: { type: '조용함', description: '조용한 환경이 자연스럽게 느껴지시는군요. 미술관의 분위기와 잘 어울려요.' },
    D: { type: '행복', description: '미술관 분위기를 긍정적으로 느끼고 계시네요. 미술 감상에 적합한 마음가짐이에요.' },
    E: { type: '짜증', description: '조용히 해야 하는 상황이 불편하게 느껴지시는군요. 더 활기찬 문화 공간이 맞을 수 있어요.' },
    F: { type: '행복', description: '미술관에서 행복을 느끼고 계시네요. 예술과의 만남이 기쁨이 되는 타입이에요.' },
    G: { type: '당당함', description: '차분한 관람 매너가 우아하게 느껴지시는군요. 예의 바른 문화 공간을 선호하는 타입이에요.' },
    H: { type: '답답함', description: '움직임이 제한되는 것이 갑갑하게 느껴지시는군요. 자유로운 활동이 더 맞을 수 있어요.' },
    I: { type: '짜증', description: '천천히 걷고 조용히 감상하는 것이 지루하게 느껴지시는군요. 역동적인 경험이 좋을 수 있어요.' },
    J: { type: '짜증', description: '규칙적인 관람이 재미없게 느껴지시는군요. 좀 더 자유로운 문화 공간을 찾아보세요.' },
    // 1단계 1번 질문 (조용히 해야 한다) — 긍정
    S1: { type: '편안함', description: '조용한 분위기가 여유롭게 느껴지시는군요. 미술관의 고요함을 즐기며 감상하는 타입이에요.' },
    S2: { type: '조용함', description: '고요한 환경이 자연스럽게 느껴지시는군요. 정적인 분위기에서 작품과 교감하는 타입이에요.' },
    S3: { type: '편안함', description: '미술관의 조용한 분위기가 편안하게 느껴지시는군요. 차분한 감상이 잘 맞는 타입이에요.' },
    S4: { type: '편안함', description: '조용한 환경에서 차분함을 느끼시는군요. 정돈된 분위기에서 내면을 들여다보는 타입이에요.' },
    S5: { type: '편안함', description: '미술관의 조용한 분위기가 평온하게 느껴지시는군요. 고요함 속에서 안정감을 느끼는 타입이에요.' },
    S6: { type: '편안함', description: '조용한 분위기에서 안정감을 느끼시는군요. 예측 가능하고 정돈된 환경을 편안하게 여기는 타입이에요.' },
    S7: { type: '조용함', description: '미술관의 분위기에서 숙연함을 느끼시는군요. 진지하고 깊이 있는 감상을 할 수 있는 타입이에요.' },
    S8: { type: '편안함', description: '조용한 공간에서 집중이 잘 되시는군요. 작품에 깊이 몰입하는 것을 좋아하는 타입이에요.' },
    S9: { type: '편안함', description: '고요함 속에서 마음이 잔잔해지시는군요. 정적인 환경에서 내면을 가다듬는 타입이에요.' },
    S10: { type: '행복', description: '조용한 미술관이 힐링이 되시는군요. 고요함을 통해 에너지를 채우는 타입이에요.' },
    S11: { type: '포근함', description: '조용한 공간이 포근하게 느껴지시는군요. 편안하고 아늑한 분위기를 즐기는 따뜻한 타입이에요.' },
    S12: { type: '편안함', description: '평화로운 분위기를 좋아하시는군요. 조용함이 주는 평화를 만끽하는 타입이에요.' },
    S13: { type: '편안함', description: '규칙을 담담하게 받아들이시는군요. 상황에 자연스럽게 적응하는 유연한 타입이에요.' },
    S14: { type: '편안함', description: '조용히 해야 하는 상황이 침착하게 느껴지시는군요. 신중하고 안정적인 행동을 선호하는 타입이에요.' },
    S15: { type: '조용함', description: '조용한 환경이 자연스럽게 느껴지시는군요. 미술관의 분위기와 잘 어울려요.' },
    // 1단계 1번 질문 — 부정
    S16: { type: '답답함', description: '조용히 해야 한다는 말에 위축되시는군요. 더 자유롭게 느낄 수 있는 공간이 맞을 수 있어요.' },
    S17: { type: '답답함', description: '조용한 분위기가 숨막히게 느껴지시는군요. 통풍이 잘 되는 듯한 열린 문화 공간이 좋을 수 있어요.' },
    S18: { type: '답답함', description: '미술관의 조용한 분위기가 답답하게 느껴지는군요. 열린 공간과 자유로움이 더 맞을 수 있어요.' },
    S19: { type: '답답함', description: '조용히 해야 하는 것이 갑갑하게 느껴지시는군요. 자유로운 활동이 더 맞을 수 있어요.' },
    S20: { type: '불쾌함', description: '조용히 해야 하는 상황이 불편하게 느껴지시는군요. 자유롭게 표현할 수 있는 공간이 더 맞을 거예요.' },
    S21: { type: '짜증', description: '조용히 해야 하는 상황이 불편하게 느껴지시는군요. 더 활기찬 문화 공간이 맞을 수 있어요.' },
    S22: { type: '답답함', description: '조용히 해야 한다는 것이 부담되시는군요. 편하게 즐기고 싶은 마음이 있는 타입이에요.' },
    S23: { type: '강렬함', description: '조용히 해야 한다는 것에 긴장되시는군요. 실수하지 않으려는 조심스러운 마음이 있는 타입이에요.' },
    S24: { type: '어색함', description: '조용히 해야 하는 상황이 어색하게 느껴지시는군요. 자연스러운 행동이 제한되어 불편함을 느끼는 타입이에요.' },
    S25: { type: '답답함', description: '조용한 공간이 우울하게 느껴지시는군요. 밝고 활기찬 분위기가 기분 전환에 도움이 될 수 있어요.' },
    S26: { type: '짜증', description: '조용한 환경이 지루하게 느껴지시는군요. 흥미롭고 자극적인 경험을 찾아가는 것이 좋을 수 있어요.' },
    S27: { type: '불쾌함', description: '미술관의 분위기가 딱딱하게 느껴지시는군요. 좀 더 부드럽고 유연한 문화 공간이 맞을 수 있어요.' },
    S28: { type: '답답함', description: '조용한 분위기가 무겁게 느껴지시는군요. 가볍고 활기찬 환경을 선호하는 타입이에요.' },
    S29: { type: '짜증', description: '조용히 해야 하는 것이 억울하게 느껴지시는군요. 조금 더 자유로웠으면 하는 타입이에요.' },
    S30: { type: '답답함', description: '조용한 분위기에 압박감을 느끼시는군요. 여유롭고 자유로운 관람을 원하는 타입이에요.' },
    // 1단계 2번 질문 (뛰면 안 된다) — 긍정
    R1: { type: '편안함', description: '천천히 걷는 규칙이 안전하게 느껴지시는군요. 차분한 관람 환경을 선호하는 타입이에요.' },
    R2: { type: '편안함', description: '뛰지 않고 걷는 것이 차분하게 느껴지시는군요. 여유롭고 침착하게 감상하는 것을 즐기는 타입이에요.' },
    R3: { type: '편안함', description: '천천히 걷는 규칙이 여유롭게 느껴지시는군요. 서두르지 않고 즐기는 타입이에요.' },
    R4: { type: '편안함', description: '천천히 걷는 것이 편안하게 느껴지시는군요. 급하지 않게 감상하는 것을 즐기는 타입이에요.' },
    R5: { type: '편안함', description: '뛰면 안 된다는 규칙을 당연하게 받아들이시는군요. 예의와 질서를 중시하는 타입이에요.' },
    R6: { type: '편안함', description: '규칙이 있는 환경에서 안정감을 느끼시는군요. 질서 있는 공간을 선호하는 타입이에요.' },
    R7: { type: '조용함', description: '규칙을 지키며 신중하게 행동하시는군요. 예의를 중시하고 배려심이 깊은 타입이에요.' },
    R8: { type: '편안함', description: '뛰지 않고 걷는 것이 침착하게 느껴지시는군요. 신중하고 안정적인 행동을 선호하는 타입이에요.' },
    R9: { type: '편안함', description: '천천히 걷는 것이 느긋하게 느껴지시는군요. 서두르지 않고 여유롭게 즐기는 타입이에요.' },
    R10: { type: '편안함', description: '규칙에 대해 담담하게 받아들이시는군요. 상황에 자연스럽게 적응하는 유연한 타입이에요.' },
    R11: { type: '편안함', description: '천천히 걷는 분위기가 평온하게 느껴지시는군요. 고요한 감상을 선호하는 타입이에요.' },
    R12: { type: '포근함', description: '차분히 걸어다니는 공간이 포근하게 느껴지시는군요. 아늑한 관람 환경을 좋아하는 타입이에요.' },
    R13: { type: '조용함', description: '걷기만 하는 규칙이 자연스럽게 느껴지시는군요. 미술관의 관람 매너와 잘 어울려요.' },
    R14: { type: '행복', description: '뛰면 안 된다는 규칙을 긍정적으로 받아들이시는군요. 질서 있는 미술관을 좋아하는 타입이에요.' },
    R15: { type: '편안함', description: '규칙의 필요성을 이해하고 받아들이시는군요. 합리적이고 이성적인 타입이에요.' },
    // 1단계 2번 질문 — 부정
    R16: { type: '답답함', description: '뛰지 못하는 상황이 답답하게 느껴지시는군요. 에너지가 넘치고 활동적인 것을 선호하는 타입이에요.' },
    R17: { type: '답답함', description: '움직임이 제한되는 것이 갑갑하게 느껴지시는군요. 자유로운 활동이 더 맞을 수 있어요.' },
    R18: { type: '불쾌함', description: '움직임이 제한되는 것이 불편하게 느껴지시는군요. 자유롭게 움직이며 탐험하는 것을 좋아하는 타입이에요.' },
    R19: { type: '답답함', description: '뛰지 못하는 규칙이 제한적으로 느껴지시는군요. 더 자유로운 관람을 원하는 타입이에요.' },
    R20: { type: '짜증', description: '천천히만 걸어야 하는 것이 짜증나시는군요. 역동적인 경험이 좋을 수 있어요.' },
    R21: { type: '짜증', description: '조용히 걷기만 하는 것이 지루하게 느껴지시는군요. 흥미롭고 자극적인 경험을 찾아가는 타입이에요.' },
    R22: { type: '답답함', description: '뛰면 안 된다는 규칙이 부담되시는군요. 편하게 움직이고 싶은 마음이 있는 타입이에요.' },
    R23: { type: '답답함', description: '움직임 규칙에 위축되시는군요. 더 자유롭게 느낄 수 있는 공간이 맞을 수 있어요.' },
    R24: { type: '짜증', description: '움직임이 제한되는 것이 억울하게 느껴지시는군요. 자유롭게 행동하고 싶은 욕구가 강한 타입이에요.' },
    R25: { type: '불쾌함', description: '뛰면 안 된다는 규칙이 딱딱하게 느껴지시는군요. 좀 더 유연한 문화 공간이 맞을 수 있어요.' },
    R26: { type: '짜증', description: '뛰지 못하는 것이 심심하게 느껴지시는군요. 흥미진진하고 역동적인 활동을 좋아하는 타입이에요.' },
    R27: { type: '짜증', description: '규칙적인 관람이 재미없게 느껴지시는군요. 좀 더 자유로운 문화 공간을 찾아보세요.' },
    R28: { type: '강렬함', description: '규칙을 지켜야 한다는 것에 긴장되시는군요. 실수하지 않으려는 조심스러운 마음이 있는 타입이에요.' },
    R29: { type: '어색함', description: '천천히 걸어야 하는 상황이 어색하게 느껴지시는군요. 자연스러운 행동이 제한되어 불편함을 느끼는 타입이에요.' },
    R30: { type: '짜증', description: '느린 관람 속도가 따분하게 느껴지시는군요. 빠르고 다채로운 경험을 원하는 타입이에요.' },
    // 1단계 3번 질문 (음식물 반입 금지) — ① 긍정
    F1: { type: '편안함', description: '음식물 반입 금지가 위생적으로 느껴지시는군요. 깨끗한 관람 환경을 선호하는 타입이에요.' },
    F2: { type: '편안함', description: '전시실이 청결하게 유지되는 것이 좋게 느껴지시는군요. 정돈된 공간을 선호하는 타입이에요.' },
    F3: { type: '편안함', description: '음식물이 없어 쾌적하다고 느끼시는군요. 편한 감상 환경을 중시하는 타입이에요.' },
    F4: { type: '편안함', description: '금지 규칙이 안전하게 느껴지시는군요. 작품과 공간이 보호되는 것을 선호하는 타입이에요.' },
    F5: { type: '편안함', description: '질서 있는 전시실이 좋게 느껴지시는군요. 규칙과 정돈을 편안하게 여기는 타입이에요.' },
    F6: { type: '편안함', description: '전문적으로 관리되는 공간이라고 느끼시는군요. 미술관의 역할을 인정하는 타입이에요.' },
    F7: { type: '편안함', description: '작품을 보호하는 규칙이라고 받아들이시는군요. 예술 보존을 소중히 여기는 타입이에요.' },
    F8: { type: '편안함', description: '책임감 있게 운영되는 공간으로 느끼시는군요. 신뢰할 수 있는 환경을 선호하는 타입이에요.' },
    F9: { type: '조용함', description: '신중한 규칙으로 받아들이시는군요. 미술관의 판단을 존중하는 타입이에요.' },
    F10: { type: '편안함', description: '엄격한 규칙이 오히려 안심되시는군요. 명확한 기준을 선호하는 타입이에요.' },
    F11: { type: '편안함', description: '집중하기 좋은 환경이라고 느끼시는군요. 작품에만 몰두하는 것을 좋아하는 타입이에요.' },
    F12: { type: '편안함', description: '차분한 분위기가 좋게 느껴지시는군요. 고요한 감상을 선호하는 타입이에요.' },
    F13: { type: '편안함', description: '안정적인 관람 환경으로 느끼시는군요. 예측 가능한 공간을 선호하는 타입이에요.' },
    F14: { type: '편안함', description: '정돈된 공간이 편안하게 느껴지시는군요. 깔끔한 전시실을 선호하는 타입이에요.' },
    F15: { type: '편안함', description: '공공성을 지키는 규칙으로 받아들이시는군요. 함께 쓰는 공간을 배려하는 타입이에요.' },
    // 1단계 3번 질문 — ② 부정
    F16: { type: '불쾌함', description: '음식물 반입 금지가 불편하게 느껴지시는군요. 자유로운 관람을 선호하는 타입이에요.' },
    F17: { type: '답답함', description: '규칙이 답답하게 느껴지시는군요. 여유롭게 즐기고 싶은 타입이에요.' },
    F18: { type: '답답함', description: '제한적으로 느껴지시는군요. 더 자유로운 관람을 원하는 타입이에요.' },
    F19: { type: '답답함', description: '규칙이 부담스럽게 느껴지시는군요. 편하게 즐기고 싶은 마음이 있는 타입이에요.' },
    F20: { type: '답답함', description: '음식물 반입이 막혀 슬프게 느껴지시는군요. 편하게 즐기고 싶은 마음이 있는 타입이에요.' },
    F21: { type: '답답함', description: '폐쇄적으로 느껴지시는군요. 열린 문화 공간을 선호하는 타입이에요.' },
    F22: { type: '불쾌함', description: '위압적으로 느껴지시는군요. 부담 없이 관람하고 싶은 타입이에요.' },
    F23: { type: '불쾌함', description: '딱딱하게 느껴지시는군요. 좀 더 유연하고 부드러운 공간을 원하는 타입이에요.' },
    F24: { type: '어색함', description: '거리감 있게 느껴지시는군요. 친근한 관람을 선호하는 타입이에요.' },
    F25: { type: '답답함', description: '자유롭지 못하다고 느끼시는군요. 여유로운 관람을 원하는 타입이에요.' },
    // 1단계 3번 질문 — ③ 중립·양가
    F26: { type: '편안함', description: '통제된 환경이 오히려 안심되시는군요. 예측 가능한 공간을 선호하는 타입이에요.' },
    F27: { type: '편안함', description: '관리되는 공간으로 받아들이시는군요. 체계적인 미술관을 선호하는 타입이에요.' },
    F28: { type: '조용함', description: '규범적인 공간으로 느끼시는군요. 정해진 질서를 자연스럽게 받아들이는 타입이에요.' },
    F29: { type: '답답함', description: '오래 관람할 때 배가 고파지겠다고 느끼시는군요. 간식 없이 보는 것이 부담되는 타입이에요.' },
    F30: { type: '편안함', description: '공식적인 규칙으로 받아들이시는군요. 명확한 기준이 있는 환경을 선호하는 타입이에요.' },
    A1: { type: '편안함', description: '미술관의 조용한 분위기가 평온하게 느껴지시는군요. 고요함 속에서 안정감을 느끼는 타입이에요.' },
    A3: { type: '편안함', description: '조용한 환경에서 차분함을 느끼시는군요. 정돈된 분위기에서 내면을 들여다보는 타입이에요.' },
    A4: { type: '짜증', description: '조용한 공간이 심심하게 느껴지시는군요. 활기차고 역동적인 문화 활동이 더 적합할 수 있어요.' },
    A5: { type: '불쾌함', description: '조용히 해야 하는 상황이 불편하게 느껴지시는군요. 자유롭게 표현할 수 있는 공간이 더 맞을 거예요.' },
    A6: { type: '짜증', description: '미술관의 정적인 분위기가 따분하게 느껴지시는군요. 변화와 자극이 있는 환경을 선호하는 타입이에요.' },
    A7: { type: '답답함', description: '조용한 공간이 우울하게 느껴지시는군요. 밝고 활기찬 분위기가 기분 전환에 도움이 될 수 있어요.' },
    A8: { type: '편안함', description: '조용한 분위기에서 안정감을 느끼시는군요. 예측 가능하고 정돈된 환경을 편안하게 여기는 타입이에요.' },
    A9: { type: '조용함', description: '조용한 공간에서 신중함을 느끼시는군요. 사려 깊게 행동하고 배려하는 마음을 가진 타입이에요.' },
    B1: { type: '짜증', description: '조용한 환경이 지루하게 느껴지시는군요. 흥미롭고 자극적인 경험을 찾아가는 것이 좋을 수 있어요.' },
    B2: { type: '조용함', description: '미술관의 분위기에서 숙연함을 느끼시는군요. 진지하고 깊이 있는 감상을 할 수 있는 타입이에요.' },
    B4: { type: '포근함', description: '조용한 공간이 포근하게 느껴지시는군요. 편안하고 아늑한 분위기를 즐기는 따뜻한 타입이에요.' },
    B5: { type: '불쾌함', description: '미술관의 분위기가 딱딱하게 느껴지시는군요. 좀 더 부드럽고 유연한 문화 공간이 맞을 수 있어요.' },
    B6: { type: '답답함', description: '조용한 분위기가 무겁게 느껴지시는군요. 가볍고 활기찬 환경을 선호하는 타입이에요.' },
    B7: { type: '편안함', description: '조용한 공간이 가볍게 느껴지시는군요. 편안하고 부담 없는 분위기를 즐기는 타입이에요.' },
    C1: { type: '답답함', description: '천천히 걸어야 하는 규칙이 답답하게 느껴지시는군요. 활동적이고 자유로운 움직임을 선호하는 타입이에요.' },
    C2: { type: '불쾌함', description: '움직임이 제한되는 것이 불편하게 느껴지시는군요. 자유롭게 움직이며 탐험하는 것을 좋아하는 타입이에요.' },
    C3: { type: '편안함', description: '천천히 걷는 것에서 차분함을 느끼시는군요. 여유롭고 침착하게 감상하는 것을 즐기는 타입이에요.' },
    C4: { type: '조용함', description: '규칙을 지키며 조심스럽게 행동하시는군요. 예의를 중시하고 배려심이 깊은 타입이에요.' },
    C5: { type: '편안함', description: '규칙에 대해 담담하게 받아들이시는군요. 상황에 자연스럽게 적응하는 유연한 타입이에요.' },
    C6: { type: '편안함', description: '뛰지 않고 걷는 것이 침착하게 느껴지시는군요. 신중하고 안정적인 행동을 선호하는 타입이에요.' },
    C7: { type: '강렬함', description: '규칙을 지켜야 한다는 것에 긴장되시는군요. 실수하지 않으려는 조심스러운 마음이 있는 타입이에요.' },
    C8: { type: '어색함', description: '천천히 걸어야 하는 상황이 어색하게 느껴지시는군요. 자연스러운 행동이 제한되어 불편함을 느끼는 타입이에요.' },
    C9: { type: '편안함', description: '천천히 걷는 것이 느긋하게 느껴지시는군요. 서두르지 않고 여유롭게 즐기는 타입이에요.' },
    D1: { type: '답답함', description: '뛰지 못하는 상황이 답답하게 느껴지시는군요. 에너지가 넘치고 활동적인 것을 선호하는 타입이에요.' },
    D2: { type: '짜증', description: '느린 관람 속도가 따분하게 느껴지시는군요. 빠르고 다채로운 경험을 원하는 타입이에요.' },
    D3: { type: '조용함', description: '정적인 환경을 그대로 받아들이시는군요. 고요하고 평온한 분위기를 이해하는 타입이에요.' },
    D4: { type: '편안함', description: '천천히 걷는 것이 편안하게 느껴지시는군요. 급하지 않게 감상하는 것을 즐기는 타입이에요.' },
    D5: { type: '편안함', description: '규칙이 있는 환경에서 안정감을 느끼시는군요. 질서 있는 공간을 선호하는 타입이에요.' },
    D6: { type: '짜증', description: '뛰지 못하는 것이 심심하게 느껴지시는군요. 흥미진진하고 역동적인 활동을 좋아하는 타입이에요.' },
    D7: { type: '짜증', description: '움직임이 제한되는 것이 억울하게 느껴지시는군요. 자유롭게 행동하고 싶은 욕구가 강한 타입이에요.' },
    V1: { type: '답답함', description: '다른 사람이 보고 있어서 아쉽게 느끼시는군요. 원하는 순간에 작품을 보는 것을 선호하는 타입이에요.' },
    V2: { type: '답답함', description: '속상하게 느끼시는군요. 내가 먼저 보고 싶었던 마음이 있는 타입이에요.' },
    V3: { type: '답답함', description: '다른 사람이 보고 있어 답답하게 느끼시는군요. 여유롭게 감상하고 싶은 타입이에요.' },
    V4: { type: '강렬함', description: '조급하게 느끼시는군요. 빨리 그 작품을 보고 싶은 마음이 있는 타입이에요.' },
    V5: { type: '강렬함', description: '초조하게 느끼시는군요. 기다리는 동안 불안한 타입이에요.' },
    V6: { type: '불쾌함', description: '불편하게 느끼시는군요. 자유롭게 관람하고 싶은 타입이에요.' },
    V7: { type: '짜증', description: '짜증이 나시는군요. 내가 보려던 작품을 다른 사람이 보고 있어서 그런 타입이에요.' },
    V8: { type: '짜증', description: '질투가 나시는군요. 그 자리에서 작품을 감상하고 싶은 마음이 강한 타입이에요.' },
    V9: { type: '어색함', description: '그 사람을 의식하게 되시는군요. 주변을 살피는 섬세한 타입이에요.' },
    V10: { type: '어색함', description: '예민해지시는군요. 다른 사람의 시선이나 존재에 민감한 타입이에요.' },
    V11: { type: '편안함', description: '이해하고 받아들이시는군요. 순서대로 보는 것을 자연스럽게 여기는 타입이에요.' },
    V12: { type: '편안함', description: '참고 기다리시는군요. 인내심이 있고 배려하는 타입이에요.' },
    V13: { type: '편안함', description: '양보하고 지나가시는군요. 다른 관람객을 배려하는 타입이에요.' },
    V14: { type: '편안함', description: '수용하고 받아들이시는군요. 상황에 유연하게 적응하는 타입이에요.' },
    V15: { type: '답답함', description: '욕심이 나시는군요. 그 작품을 지금 당장 보고 싶은 마음이 있는 타입이에요.' },
    V16: { type: '강렬함', description: '불안하게 느끼시는군요. 기다리는 동안 불편함을 느끼는 타입이에요.' },
    V17: { type: '편안함', description: '관대해지시는군요. 다른 사람이 먼저 보는 것을 너그럽게 받아들이는 타입이에요.' },
    V18: { type: '어색함', description: '눈치가 보이시는군요. 주변 분위기와 상대를 의식하는 타입이에요.' },
    V19: { type: '짜증', description: '억울하게 느끼시는군요. 내가 먼저 왔는데도 못 보는 것이 서운한 타입이에요.' },
    V20: { type: '조용함', description: '조심스럽게 행동하시는군요. 방해하지 않으려 배려하는 타입이에요.' },
    V21: { type: '강렬함', description: '긴장되시는군요. 다른 사람이 있어 불편하게 느끼는 타입이에요.' },
    V22: { type: '편안함', description: '침착해지시는군요. 기다리는 동안에도 차분함을 유지하는 타입이에요.' },
    V23: { type: '편안함', description: '괜찮게 받아들이시는군요. 조금 기다렸다가 보면 되겠다고 생각하는 타입이에요.' },
    V24: { type: '편안함', description: '편하게 느끼시는군요. 다른 사람이 보는 것도 자연스러운 일로 받아들이는 타입이에요.' },
    V25: { type: '편안함', description: '자연스럽게 느끼시는군요. 미술관에서 순서를 기다리는 것을 당연히 여기는 타입이에요.' },
    V26: { type: '편안함', description: '여유롭게 기다리시는군요. 다른 관람객을 배려하며 침착한 타입이에요.' },
    V27: { type: '편안함', description: '당연하다고 받아들이시는군요. 먼저 온 사람이 먼저 보는 것이 맞다고 생각하는 타입이에요.' },
    V28: { type: '편안함', description: '같은 작품을 보려는 사람이 있어 반갑게 느끼시는군요. 비슷한 취향을 가진 사람과 공간을 나누는 것을 좋아하는 타입이에요.' },
    V29: { type: '편안함', description: '그 사람의 감상에 공감하게 되시는군요. 다른 사람도 그 작품을 보고 싶어할 수 있다고 이해하는 타입이에요.' },
    V30: { type: '강렬함', description: '안절부절하시는군요. 기다리는 동안 마음이 조급한 타입이에요.' },
    W1: { type: '편안함', description: '작품이 궁금하게 느껴지시는군요. 이해하려는 호기심이 있는 타입이에요.' },
    W2: { type: '편안함', description: '작품에 집중하게 되시는군요. 깊이 감상하는 것을 좋아하는 타입이에요.' },
    W3: { type: '편안함', description: '작품에 몰입하게 되시는군요. 예술과 하나 되는 감상을 즐기는 타입이에요.' },
    W4: { type: '조용함', description: '이해하려 할 때 신중하게 대하시는군요. 천천히 음미하는 타입이에요.' },
    W5: { type: '조용함', description: '조심스럽게 바라보게 되시는군요. 작품을 소중히 대하는 타입이에요.' },
    W6: { type: '어색함', description: '작품이 낯설게 느껴지시는군요. 새로운 것을 받아들이는 데 시간이 걸리는 타입이에요.' },
    W7: { type: '답답함', description: '이해하기 어렵게 느끼시는군요. 조금 더 쉽게 다가가고 싶은 타입이에요.' },
    W8: { type: '답답함', description: '이해가 안 되어 답답하게 느끼시는군요. 빨리 통하고 싶은 마음이 있는 타입이에요.' },
    W9: { type: '답답함', description: '혼란스럽게 느끼시는군요. 정리가 되지 않아 불편한 타입이에요.' },
    W10: { type: '답답함', description: '막막하게 느끼시는군요. 어디서부터 이해해야 할지 모르겠는 타입이에요.' },
    W11: { type: '행복', description: '작품이 흥미롭게 느껴지시는군요. 탐구하는 즐거움을 아는 타입이에요.' },
    W12: { type: '행복', description: '이해하려는 과정이 재미있게 느껴지시는군요. 감상을 즐기는 타입이에요.' },
    W13: { type: '편안함', description: '도전적으로 느끼시는군요. 낯선 작품도 맞서 보는 타입이에요.' },
    W14: { type: '편안함', description: '의욕이 생기시는군요. 이해해 보려는 동력이 있는 타입이에요.' },
    W15: { type: '편안함', description: '끈기가 있게 느끼시는군요. 포기하지 않고 끝까지 보려는 타입이에요.' },
    W16: { type: '편안함', description: '집요하게 파고들게 되시는군요. 이해할 때까지 붙어 보는 타입이에요.' },
    W17: { type: '조용함', description: '세심하게 바라보게 되시는군요. 디테일까지 놓치지 않는 타입이에요.' },
    W18: { type: '어색함', description: '이해하려다 예민해지시는군요. 작품에 과하게 반응하는 타입이에요.' },
    W19: { type: '답답함', description: '작품을 이해하려다 스트레스를 받으시는군요. 부담 없이 감상하고 싶은 타입이에요.' },
    W20: { type: '어색함', description: '작품과 거리감이 느껴지시는군요. 쉽게 다가가지 못하는 타입이에요.' },
    W21: { type: '편안함', description: '작품이 새롭게 느껴지시는군요. 처음 보는 느낌을 즐기는 타입이에요.' },
    W22: { type: '편안함', description: '통찰하게 되시는군요. 작품 속 의미를 꿰뚫어 보는 타입이에요.' },
    W23: { type: '행복', description: '무언가 깨닫게 되시는군요. 이해의 순간을 경험하는 타입이에요.' },
    W24: { type: '행복', description: '뿌듯하게 느끼시는군요. 이해한 자신에게 만족하는 타입이에요.' },
    W25: { type: '행복', description: '성취감을 느끼시는군요. 노력 끝에 이해한 보람이 있는 타입이에요.' },
    W26: { type: '편안함', description: '작품을 보며 성찰하게 되시는군요. 내면을 돌아보는 타입이에요.' },
    W27: { type: '강렬함', description: '이해하려 할 때 긴장되시는군요. 잘 이해할 수 있을지 불안한 타입이에요.' },
    W28: { type: '행복', description: '작품을 이해하려 할 때 설레시는군요. 기대감이 있는 타입이에요.' },
    W29: { type: '편안함', description: '호기심이 생기시는군요. 더 알고 싶다는 욕구가 있는 타입이에요.' },
    W30: { type: '행복', description: '이해한 결과가 만족스럽게 느껴지시는군요. 감상에 보람을 느끼는 타입이에요.' },
    X1: { type: '답답함', description: '어떤 옷을 입을지 고민되시는군요. 복장 선택에 시간이 걸리는 타입이에요.' },
    X2: { type: '어색함', description: '옷 고를 때 망설여지시는군요. 결정이 서지 않아 불편한 타입이에요.' },
    X3: { type: '어색함', description: '미술관 복장에 신경이 쓰이시는군요. 다른 사람 시선을 의식하는 타입이에요.' },
    X4: { type: '어색함', description: '옷차림을 의식하게 되시는군요. 미술관 분위기에 맞추려는 타입이에요.' },
    X5: { type: '행복', description: '미술관 가는 일이 설레시는군요. 나들이를 기대하는 타입이에요.' },
    X6: { type: '행복', description: '미술관에 가는 것이 기대되시는군요. 준비하는 과정도 즐기는 타입이에요.' },
    X7: { type: '강렬함', description: '복장 때문에 긴장되시는군요. 적절한 차림을 고민하는 타입이에요.' },
    X8: { type: '답답함', description: '옷 고르기가 부담스럽게 느껴지시는군요. 편하게 입고 싶은 타입이에요.' },
    X9: { type: '조용함', description: '조심스럽게 고르게 되시는군요. 미술관에 맞는 복장을 신경 쓰는 타입이에요.' },
    X10: { type: '답답함', description: '뭘 입을지 걱정되시는군요. 틀리지 않을까 불안한 타입이에요.' },
    X11: { type: '강렬함', description: '복장이 불안하게 느껴지시는군요. 잘못 입으면 어떡하나 걱정하는 타입이에요.' },
    X12: { type: '어색함', description: '옷차림에 자신이 없으시는군요. 다른 사람 눈치가 보이는 타입이에요.' },
    X13: { type: '당당함', description: '잘 보이고 싶게 느끼시는군요. 미술관에서 품격 있게 보이려는 타입이에요.' },
    X14: { type: '편안함', description: '튀고 싶지 않게 느끼시는군요. 무난한 차림을 선호하는 타입이에요.' },
    X15: { type: '행복', description: '미술관에 갈 생각에 행복하게 느끼시는군요. 나들이 준비 자체를 즐기는 타입이에요.' },
    X16: { type: '당당함', description: '격식을 차리고 싶게 느끼시는군요. 미술관에 맞는 정장을 선호하는 타입이에요.' },
    X17: { type: '편안함', description: '편하게 입고 싶게 느끼시는군요. 부담 없는 차림을 선호하는 타입이에요.' },
    X18: { type: '어색함', description: '미술관 복장에 눈치가 보이시는군요. 주변 분위기를 읽는 타입이에요.' },
    X19: { type: '답답함', description: '옷 고르다 위축되시는군요. 격식 있는 공간이 부담되는 타입이에요.' },
    X20: { type: '행복', description: '미술관 가는 생각에 들뜨시는군요. 기대에 차 있는 타입이에요.' },
    X21: { type: '행복', description: '옷 고르다 기분이 좋아지시는군요. 나들이 준비를 즐기는 타입이에요.' },
    X22: { type: '어색함', description: '어떤 옷이 맞을지 어색하게 느끼시는군요. 미술관 분위기가 낯선 타입이에요.' },
    X23: { type: '답답함', description: '옷 고르다 스트레스를 받으시는군요. 복장 때문에 부담되는 타입이에요.' },
    X24: { type: '답답함', description: '뭘 입어야 할지 답답하게 느끼시는군요. 선택지가 마땅하지 않은 타입이에요.' },
    X25: { type: '편안함', description: '어떤 옷이든 괜찮다고 느끼시는군요. 복장에 크게 구애받지 않는 타입이에요.' },
    X26: { type: '편안함', description: '편한 옷이면 자연스럽게 느끼시는군요. 무리하지 않는 차림을 선호하는 타입이에요.' },
    X27: { type: '답답함', description: '옷 고르기가 부담되시는군요. 미술관에 맞춰 입어야 한다는 압박이 있는 타입이에요.' },
    X28: { type: '답답함', description: '어디서부터 골라야 할지 막막하게 느끼시는군요. 선택이 어려운 타입이에요.' },
    X29: { type: '편안함', description: '편한 옷을 생각하면 편안하게 느끼시는군요. 부담 없는 차림을 좋아하는 타입이에요.' },
    X30: { type: '당당함', description: '옷을 고르며 당당해지시는군요. 미술관에 어울리는 차림으로 자신감을 갖는 타입이에요.' },
    FA1: { type: '두근거림', description: '멀리서 보는 작품이 아련하게 느껴지시는군요. 감성적인 감상 타입이에요.' },
    FA2: { type: '조용함', description: '멀리서 보는 작품이 멀게 느껴지시는군요. 거리를 두고 감상하는 타입이에요.' },
    FA3: { type: '당당함', description: '멀리서도 선명하게 보이시는군요. 시각적 인지가 좋은 타입이에요.' },
    FA4: { type: '어색함', description: '멀리서 보는 작품이 흐릿하게 느껴지시는군요. 가까이서 감상하는 타입이에요.' },
    FA5: { type: '편안함', description: '멀리서 보는 작품에서 평온함을 느끼시는군요. 고요한 감상을 선호하는 타입이에요.' },
    FA6: { type: '두근거림', description: '멀리서 보며 궁금함을 느끼시는군요. 호기심이 많은 타입이에요.' },
    FA7: { type: '당당함', description: '멀리서 보는 작품이 당당하게 느껴지시는군요. 위엄을 느끼는 타입이에요.' },
    FA8: { type: '조용함', description: '멀리서 보는 작품이 조용하게 느껴지시는군요. 고요한 감상을 선호하는 타입이에요.' },
    FA9: { type: '당당함', description: '멀리서 보는 작품에서 위엄을 느끼시는군요. 거장적 감상을 하는 타입이에요.' },
    FA10: { type: '두근거림', description: '멀리서 보는 작품이 신비롭게 느껴지시는군요. 상상력이 풍부한 타입이에요.' },
    FA11: { type: '답답함', description: '멀리서 보는 작품이 답답하게 느껴지시는군요. 가까이서 감상하는 타입이에요.' },
    FA12: { type: '편안함', description: '멀리서 보는 작품이 편안하게 느껴지시는군요. 여유로운 감상을 선호하는 타입이에요.' },
    FA13: { type: '답답함', description: '멀리서 보는 작품이 외롭게 느껴지시는군요. 감성적인 타입이에요.' },
    FA14: { type: '어색함', description: '멀리서 보는 작품이 모호하게 느껴지시는군요. 명확함을 선호하는 타입이에요.' },
    FA15: { type: '강렬함', description: '멀리서도 강렬하게 느껴지시는군요. 강한 인상을 받는 타입이에요.' },
    FA16: { type: '포근함', description: '멀리서 보는 작품이 부드럽게 느껴지시는군요. 은은한 감상을 선호하는 타입이에요.' },
    FA17: { type: '불쾌함', description: '멀리서 보는 작품이 차갑게 느껴지시는군요. 냉정한 감상을 하는 타입이에요.' },
    FA18: { type: '포근함', description: '멀리서 보는 작품이 따뜻하게 느껴지시는군요. 온기 있는 감상을 하는 타입이에요.' },
    FA19: { type: '강렬함', description: '멀리서 보는 작품이 낯설게 느껴지시는군요. 새로운 것을 탐구하는 타입이에요.' },
    FA20: { type: '편안함', description: '멀리서 보는 작품이 친숙하게 느껴지시는군요. 익숙한 감상을 선호하는 타입이에요.' },
    CA1: { type: '강렬함', description: '가까이서 보는 작품에 압도되시는군요. 강한 인상을 받는 타입이에요.' },
    CA2: { type: '당당함', description: '가까이서 보는 작품이 선명하게 느껴지시는군요. 디테일을 즐기는 타입이에요.' },
    CA3: { type: '포근함', description: '가까이서 보는 작품이 가깝게 느껴지시는군요. 친밀한 감상을 선호하는 타입이에요.' },
    CA4: { type: '강렬함', description: '가까이서 보는 작품이 섬뜩하게 느껴지시는군요. 독특한 감각을 가진 타입이에요.' },
    CA5: { type: '포근함', description: '가까이서 보는 작품이 친근하게 느껴지시는군요. 작품과 교감하는 타입이에요.' },
    CA6: { type: '강렬함', description: '가까이서 보는 작품에 긴장되시는군요. 집중하는 타입이에요.' },
    CA7: { type: '두근거림', description: '가까이서 보는 작품에 설레시는군요. 기대감이 있는 타입이에요.' },
    CA8: { type: '강렬함', description: '가까이서 보는 작품이 두렵게 느껴지시는군요. 신중한 타입이에요.' },
    CA9: { type: '행복', description: '가까이서 보는 작품에 감동하시는군요. 감성적인 타입이에요.' },
    CA10: { type: '두근거림', description: '가까이서 보며 호기심을 느끼시는군요. 탐구하는 타입이에요.' },
    CA11: { type: '답답함', description: '가까이서 보는 작품이 답답하게 느껴지시는군요. 거리를 두는 타입이에요.' },
    CA12: { type: '편안함', description: '가까이서 보는 작품이 편안하게 느껴지시는군요. 친밀한 감상을 선호하는 타입이에요.' },
    CA13: { type: '두근거림', description: '가까이서 보는 작품이 신비롭게 느껴지시는군요. 상상력이 풍부한 타입이에요.' },
    CA14: { type: '당당함', description: '가까이서 보는 작품이 당당하게 느껴지시는군요. 위엄을 느끼는 타입이에요.' },
    CA15: { type: '강렬함', description: '가까이서 보는 작품이 강렬하게 느껴지시는군요. 강한 인상을 받는 타입이에요.' },
    CA16: { type: '포근함', description: '가까이서 보는 작품이 부드럽게 느껴지시는군요. 은은한 감상을 선호하는 타입이에요.' },
    CA17: { type: '조용함', description: '가까이서 보는 작품의 섬세함을 느끼시는군요. 디테일을 즐기는 타입이에요.' },
    CA18: { type: '강렬함', description: '가까이서 보는 작품이 거대하게 느껴지시는군요. 스케일에 압도되는 타입이에요.' },
    CA19: { type: '조용함', description: '가까이서 보는 작품이 작게 느껴지시는군요. 섬세한 것을 선호하는 타입이에요.' },
    CA20: { type: '답답함', description: '가까이서 보는 작품에 압박감을 느끼시는군요. 거리를 두는 타입이에요.' },
    EM1: { type: '행복', description: '작품이 좋게 느껴지시는군요. 긍정적으로 감상하는 타입이에요.' },
    EM2: { type: '행복', description: '작품에 반하시는군요. 마음이 끌리는 감상을 하는 타입이에요.' },
    EM3: { type: '행복', description: '작품에 감탄하시는군요. 반짝이는 인상을 받는 타입이에요.' },
    EM4: { type: '편안함', description: '작품을 관찰하고 탐구하게 되시는군요. 꼼꼼히 보는 타입이에요.' },
    EM5: { type: '편안함', description: '작품이 쿨하고 여유롭게 느껴지시는군요. 담담히 감상하는 타입이에요.' },
    EM6: { type: '답답함', description: '작품이 슬프거나 쓸쓸하게 느껴지시는군요. 감성적으로 여운이 남는 타입이에요.' },
    EM7: { type: '강렬함', description: '작품이 흔들리거나 당황스럽게 느껴지시는군요. 강한 인상을 받는 타입이에요.' },
    EM8: { type: '답답함', description: '작품이 지루하거나 졸리게 느껴지시는군요. 집중이 잘 안 되는 타입이에요.' },
    EM9: { type: '답답함', description: '작품이 어지럽거나 혼란스럽게 느껴지시는군요. 정리가 안 되는 타입이에요.' },
    EM10: { type: '편안함', description: '작품을 깊이 생각하게 되시는군요. 의미를 찾아보는 타입이에요.' },
    CP1: { type: '편안함', description: '캡션을 읽은 후 이해가 되시는군요. 설명이 작품 감상을 돕는 타입이에요.' },
    CP2: { type: '편안함', description: '캡션을 읽은 후 분석적으로 바라보시는군요. 맥락을 꼼꼼히 읽는 타입이에요.' },
    CP3: { type: '편안함', description: '캡션을 읽은 후 비판적으로 보시는군요. 설명과 작품을 견주어 생각하는 타입이에요.' },
    CP4: { type: '강렬함', description: '캡션을 읽은 후 긴장되시는군요. 설명이 부담이 되는 타입이에요.' },
    CP5: { type: '편안함', description: '캡션을 읽은 후 의미가 있다고 느끼시는군요. 맥락이 감상을 풍부하게 하는 타입이에요.' },
    CP6: { type: '편안함', description: '캡션을 읽은 후 선명하게 느껴지시는군요. 설명이 작품을 또렷하게 만들어 주는 타입이에요.' },
    CP7: { type: '편안함', description: '캡션을 읽은 후 차분해지시는군요. 맥락이 감상을 가라앉히는 타입이에요.' },
    CP8: { type: '편안함', description: '캡션을 읽은 후 객관적으로 보시는군요. 설명을 통해 거리를 두고 감상하는 타입이에요.' },
    CP9: { type: '편안함', description: '캡션을 읽은 후 이성적으로 받아들이시는군요. 논리적으로 이해하는 타입이에요.' },
    CP10: { type: '편안함', description: '캡션을 읽은 후 머릿속이 정리되시는군요. 설명이 감상을 정돈해 주는 타입이에요.' },
    CP11: { type: '편안함', description: '캡션을 읽은 후 논리적으로 느껴지시는군요. 구조를 파악하며 보는 타입이에요.' },
    CP12: { type: '편안함', description: '캡션을 읽은 후 냉정하게 바라보시는군요. 감정보다 판단을 중시하는 타입이에요.' },
    CP13: { type: '편안함', description: '캡션을 읽은 후 집중이 되시는군요. 설명이 감상에 몰입하게 하는 타입이에요.' },
    CP14: { type: '편안함', description: '캡션을 읽은 후 분명하게 느껴지시는군요. 설명이 의도를 명확히 하는 타입이에요.' },
    CP15: { type: '편안함', description: '캡션을 읽은 후 또렷하게 보이시는군요. 맥락이 작품을 선명하게 하는 타입이에요.' },
    CP16: { type: '편안함', description: '캡션을 읽은 후 구조적으로 이해되시는군요. 체계적으로 감상하는 타입이에요.' },
    CP17: { type: '어색함', description: '캡션을 읽은 후 거리감이 느껴지시는군요. 설명과 작품 사이가 멀게 느껴지는 타입이에요.' },
    CP18: { type: '편안함', description: '캡션을 읽은 후 담담하게 받아들이시는군요. 설명에 감정을 덜 실리는 타입이에요.' },
    CP19: { type: '편안함', description: '캡션을 읽은 후 정돈되게 느껴지시는군요. 맥락이 감상을 정리해 주는 타입이에요.' },
    CP20: { type: '편안함', description: '캡션을 읽은 후 명확하게 이해되시는군요. 설명이 작품을 뚜렷하게 하는 타입이에요.' },
    CP21: { type: '행복', description: '캡션을 읽은 후 흥미롭게 느끼시는군요. 설명이 감상을 풍부하게 하는 타입이에요.' },
    CP22: { type: '편안함', description: '캡션을 읽은 후 관찰적으로 보시는군요. 설명을 바탕으로 세밀히 감상하는 타입이에요.' },
    CP23: { type: '행복', description: '캡션을 읽은 후 재미있게 느끼시는군요. 맥락이 감상을 즐겁게 하는 타입이에요.' },
    CP24: { type: '조용함', description: '캡션을 읽은 후 조용히 가라앉으시는군요. 설명이 고요한 감상을 주는 타입이에요.' },
    CP25: { type: '편안함', description: '캡션을 읽은 후 진지하게 바라보시는군요. 설명을 통해 깊이 생각하는 타입이에요.' },
    CP26: { type: '편안함', description: '캡션을 읽은 후 생각하게 되시는군요. 맥락이 사유를 이끄는 타입이에요.' },
    CP27: { type: '답답함', description: '캡션을 읽은 후 압박감이 드시는군요. 설명이 부담이 되는 타입이에요.' },
    CP28: { type: '답답함', description: '캡션을 읽은 후 어렵게 느끼시는군요. 설명이 오히려 난해한 타입이에요.' },
    CP29: { type: '답답함', description: '캡션을 읽은 후 스트레스를 받으시는군요. 설명이 부담이 되는 타입이에요.' },
    CP30: { type: '어색함', description: '캡션을 읽은 후 눈치가 보이시는군요. 설명이나 맥락을 의식하며 보는 타입이에요.' },
  },
};

// Supabase: config.js 또는 아래 직접 입력. config.js의 SUPABASE_ANON_KEY에 키를 넣으세요.
const SUPABASE_KEY_FALLBACK = ''; // config.js에 안 넣었으면 여기에 anon key 붙여넣기
function getSupabaseClient() {
  const url = (window.SUPABASE_URL || '').trim();
  const key = (window.SUPABASE_ANON_KEY || SUPABASE_KEY_FALLBACK || '').trim();
  if (!url || !key) return null;
  try {
    const s = window.supabase;
    if (s && typeof s.createClient === 'function') return s.createClient(url, key);
    if (s && typeof s === 'function') return s(url, key);
    if (typeof createClient === 'function') return createClient(url, key);
  } catch (e) {
    console.error('Supabase 클라이언트 생성 실패:', e);
  }
  if (!url || !key) {
    console.warn('Supabase: config.js의 SUPABASE_ANON_KEY 또는 main.js의 SUPABASE_KEY_FALLBACK에 anon key를 입력하세요.');
  }
  return null;
}
let _supabaseClient = null;
const supabaseClient = () => {
  if (!_supabaseClient) _supabaseClient = getSupabaseClient();
  return _supabaseClient;
};

async function saveResultToSupabase(resultType) {
  const client = supabaseClient();
  if (!client || !selectedGender || !selectedMode) return;
  const { error } = await client.from('test_results').insert({
    gender: selectedGender,
    mode: selectedMode,
    result_type: resultType,
  });
  if (error) console.error('Supabase 저장 실패:', error);
}

async function loadSimilarResults() {
  const client = supabaseClient();
  if (!client || !selectedGender || !selectedMode) return [];
  const { data, error } = await client
    .from('test_results')
    .select('result_type')
    .eq('gender', selectedGender)
    .eq('mode', selectedMode);
  if (error) {
    console.error('Supabase 조회 실패:', error);
    return [];
  }
  return data || [];
}

// 유형별 고정 색상 - 11가지 유형만, 다양한 색감
const TYPE_COLOR_MAP = {
  편안함: { color: '#22c55e', glow: '0 0 14px #22c55e', cls: 'star-green' },
  답답함: { color: '#3b82f6', glow: '0 0 14px #3b82f6', cls: 'star-blue' },
  조용함: { color: '#f8fafc', glow: '0 0 14px #f8fafc', cls: 'star-white' },
  포근함: { color: '#c71585', glow: '0 0 14px #c71585', cls: 'star-pink' },
  불쾌함: { color: '#6b7280', glow: '0 0 14px #6b7280', cls: 'star-gray' },
  어색함: { color: '#a855f7', glow: '0 0 14px #a855f7', cls: 'star-purple' },
  당당함: { color: '#92400e', glow: '0 0 14px #92400e', cls: 'star-brown' },
  행복: { color: '#eab308', glow: '0 0 14px #eab308', cls: 'star-yellow' },
  짜증: { color: '#f97316', glow: '0 0 14px #f97316', cls: 'star-orange' },
  강렬함: { color: '#dc2626', glow: '0 0 14px #dc2626', cls: 'star-red-dark' },
  두근거림: { color: '#f472b6', glow: '0 0 14px #f472b6', cls: 'star-pink-light' },
  흐릿함: { color: '#94a3b8', glow: '0 0 14px #94a3b8', cls: 'star-slate' },
  웅장함: { color: '#b45309', glow: '0 0 14px #b45309', cls: 'star-amber' },
  현실적: { color: '#64748b', glow: '0 0 14px #64748b', cls: 'star-slate-dark' },
  친근함: { color: '#4ade80', glow: '0 0 14px #4ade80', cls: 'star-mint' },
  긴장됨: { color: '#f59e0b', glow: '0 0 14px #f59e0b', cls: 'star-amber-light' },
  압도적: { color: '#ef4444', glow: '0 0 14px #ef4444', cls: 'star-red' },
  섬세함: { color: '#c084fc', glow: '0 0 14px #c084fc', cls: 'star-violet' },
  거대함: { color: '#0ea5e9', glow: '0 0 14px #0ea5e9', cls: 'star-sky' },
  숙연함: { color: '#1e3a5f', glow: '0 0 14px #1e3a5f', cls: 'star-navy' },
  차분함: { color: '#14b8a6', glow: '0 0 14px #14b8a6', cls: 'star-teal' },
};

const FALLBACK_STYLE = { color: '#00f5ff', glow: '0 0 12px #00f5ff', cls: 'star-default' };

function getStyleForType(type) {
  return TYPE_COLOR_MAP[type] || FALLBACK_STYLE;
}

function setResultStar(resultType, isMyResult = true) {
  const starEl = $('result-star');
  const textEl = $('result-type');
  if (!starEl || !textEl) return;
  const style = getStyleForType(resultType);
  starEl.textContent = '★';
  starEl.className = 'result-star ' + style.cls + (isMyResult ? ' result-star-mine' : '');
  starEl.style.color = style.color;
  starEl.style.textShadow = style.glow;
  textEl.style.color = style.color;
  textEl.style.webkitTextFillColor = style.color;
  textEl.style.background = 'none';
  textEl.style.backgroundClip = 'unset';
  textEl.style.webkitBackgroundClip = 'unset';
  textEl.style.textShadow = style.glow;
}

function renderOthersResults(countByType, hasSupabase = true) {
  const el = $('others-results');
  if (!el) return;
  const entries = Object.entries(countByType).sort((a, b) => b[1] - a[1]);
  if (entries.length === 0) {
    el.innerHTML = hasSupabase
      ? '<p class="others-results-empty">아직 나와 같은 설정의 별들이 없습니다.</p>'
      : '<p class="others-results-empty">통계 기능을 사용하려면 Supabase URL과 키를 설정해 주세요.</p>';
    return;
  }
  const stars = [];
  entries.forEach(([type, count]) => {
    const style = getStyleForType(type);
    for (let k = 0; k < count; k++) {
      stars.push({ type, count, color: style.color, glow: style.glow, cls: style.cls });
    }
  });
  for (let i = stars.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [stars[i], stars[j]] = [stars[j], stars[i]];
  }
  el.innerHTML = `
    <p class="others-results-title">나와 같은 설정의 별들</p>
    <div class="star-sky">
      ${stars.map((s) => {
        const left = (2 + Math.random() * 88).toFixed(1);
        const top = (2 + Math.random() * 88).toFixed(1);
        return `
        <span class="sky-star ${s.cls}" 
          style="color:${s.color};text-shadow:${s.glow};left:${left}%;top:${top}%;"
          data-type="${s.type}"
          data-count="${s.count}"
          title="${s.type} · ${s.count}명">★</span>
      `;
      }).join('')}
    </div>
  `;
  el.querySelectorAll('.sky-star').forEach(star => {
    star.addEventListener('mouseenter', showStarTooltip);
    star.addEventListener('mouseleave', hideStarTooltip);
    star.addEventListener('click', (e) => { e.preventDefault(); showStarTooltip(e); });
    star.addEventListener('touchstart', (e) => { showStarTooltip(e); }, { passive: true });
  });
  if (!window._starTooltipOutsideHandler) {
    window._starTooltipOutsideHandler = (e) => {
      if (e.target.closest('.sky-star') || e.target.closest('.star-tooltip')) return;
      hideStarTooltip();
    };
    document.addEventListener('click', window._starTooltipOutsideHandler);
    document.addEventListener('touchstart', window._starTooltipOutsideHandler);
  }
}

let starTooltip = null;
function showStarTooltip(e) {
  const el = e.currentTarget;
  hideStarTooltip();
  starTooltip = document.createElement('div');
  starTooltip.className = 'star-tooltip';
  starTooltip.textContent = `${el.dataset.type} · ${el.dataset.count}명`;
  document.body.appendChild(starTooltip);
  const rect = el.getBoundingClientRect();
  const ttW = starTooltip.offsetWidth;
  let left = rect.left + rect.width / 2 - ttW / 2;
  const top = rect.top - 34;
  if (left < 8) left = 8;
  if (left + ttW > window.innerWidth - 8) left = window.innerWidth - ttW - 8;
  starTooltip.style.left = left + 'px';
  starTooltip.style.top = top + 'px';
}
function hideStarTooltip() {
  if (starTooltip && starTooltip.parentNode) starTooltip.parentNode.removeChild(starTooltip);
  starTooltip = null;
}

let currentQuestionIndex = 0;
let answers = [];
let selectedWork = null;
let selectedWorks = [];   // 3단계: 선택한 작품 5개 (A~O 중)
let workSliderAnswers = []; // 3단계 far: 작품별 [s1,s2,s3] 슬라이더 값 (0-100)
let selectedGender = null; // 남 | 녀
let selectedMode = null;   // 어린이 | 청소년 | 청년 | 중장년 | 뉴비 | 중수 | 고수

const BASIC_QUESTIONS = 6;   // 1+2단계 질문 수
const WORKS_TO_SELECT = 3;   // 3단계에서 선택할 작품 수
const QUESTIONS_PER_WORK = 7; // 작품당 질문 수 (멀리준비, 멀리, 가까이준비, 가까이, 캡션준비, 캡션감정, 감정)

const $ = (id) => document.getElementById(id);
const $$ = (selector) => document.querySelectorAll(selector);

const screens = {
  start: $('start-screen'),
  settings: $('settings-screen'),
  workSelect: $('work-select-screen'),
  question: $('question-screen'),
  result: $('result-screen')
};

const showScreen = (screen) => {
  Object.values(screens).forEach(s => s?.classList.remove('active'));
  screen?.classList.add('active');
};

function initStaticNoise() {
  const container = $('static-noise');
  if (!container) return;

  const canvas = document.createElement('canvas');
  canvas.width = 256;
  canvas.height = 256;
  const ctx = canvas.getContext('2d');

  const drawNoise = () => {
    const imageData = ctx.createImageData(256, 256);
    for (let i = 0; i < imageData.data.length; i += 4) {
      const v = Math.random() * 255;
      imageData.data[i] = imageData.data[i + 1] = imageData.data[i + 2] = v;
      imageData.data[i + 3] = 80;
    }
    ctx.putImageData(imageData, 0, 0);
    container.style.backgroundImage = `url(${canvas.toDataURL()})`;
  };

  drawNoise();
  container.style.backgroundSize = '100px 100px';

  const noiseInterval = setInterval(() => {
    if (!screens.settings.classList.contains('active')) {
      clearInterval(noiseInterval);
    } else {
      drawNoise();
    }
  }, 80);
}

function setupSettingsScreen() {
  $$('.setting-gender').forEach(btn => {
    btn.addEventListener('click', () => {
      $$('.setting-gender').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedGender = btn.dataset.value;
      $('btn-confirm').disabled = !(selectedGender && selectedMode);
    });
  });

  $$('.setting-mode').forEach(btn => {
    btn.addEventListener('click', () => {
      $$('.setting-mode').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedMode = btn.dataset.value;
      $('btn-confirm').disabled = !(selectedGender && selectedMode);
    });
  });

  $('btn-confirm').addEventListener('click', () => {
    showScreen(screens.question);
    renderQuestion();
  });
}

function escapeHtml(s) {
  if (typeof s !== 'string') return s;
  return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function renderWorkSelect() {
  const container = $('exhibition-categories');
  const existingConfirm = container.parentElement?.querySelector('.work-select-confirm');
  if (existingConfirm) existingConfirm.remove();

  container.innerHTML = Object.entries(quizData.exhibition)
    .map(([roomName, works]) => `
      <div class="exhibition-category">
        <button type="button" class="category-toggle" aria-expanded="false">
          <span class="category-name">${roomName}</span>
          <span class="category-arrow">▼</span>
        </button>
        <div class="category-works" aria-hidden="true">
          ${works.map((work, idx) => {
            const isSelected = selectedWorks.includes(work);
            const label = quizData.workLabels?.[work] || work;
            const labelSafe = escapeHtml(label);
            return `
            <button type="button" class="work-option option-wiggle option-wiggle-${(idx % 6) + 1} ${isSelected ? 'selected' : ''}" data-work="${work}" title="${labelSafe}">${labelSafe}</button>
          `}).join('')}
        </div>
      </div>
    `).join('');

  const confirmWrap = document.createElement('div');
  confirmWrap.className = 'work-select-confirm';
  confirmWrap.innerHTML = `
    <button type="button" class="btn-confirm-works glitch-btn" id="btn-confirm-works" disabled><span>감상 시작</span></button>
  `;
  container.parentElement?.appendChild(confirmWrap);

  container.querySelectorAll('.category-toggle').forEach(btn => {
    btn.addEventListener('click', () => {
      const category = btn.closest('.exhibition-category');
      const isOpen = category.classList.contains('open');

      container.querySelectorAll('.exhibition-category').forEach(c => {
        c.classList.remove('open');
        c.querySelector('.category-toggle').setAttribute('aria-expanded', 'false');
        c.querySelector('.category-works').setAttribute('aria-hidden', 'true');
      });

      if (!isOpen) {
        category.classList.add('open');
        btn.setAttribute('aria-expanded', 'true');
        category.querySelector('.category-works').setAttribute('aria-hidden', 'false');
      }
    });
  });

  function updateConfirmButton() {
    const btn = $('btn-confirm-works');
    if (btn) btn.disabled = selectedWorks.length !== WORKS_TO_SELECT;
  }

  container.querySelectorAll('.work-option').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const work = btn.dataset.work;
      const idx = selectedWorks.indexOf(work);
      if (idx >= 0) {
        selectedWorks.splice(idx, 1);
        btn.classList.remove('selected');
      } else if (selectedWorks.length < WORKS_TO_SELECT) {
        selectedWorks.push(work);
        btn.classList.add('selected');
      }
      updateConfirmButton();
    });
  });

  $('btn-confirm-works')?.addEventListener('click', () => {
    if (selectedWorks.length !== WORKS_TO_SELECT) return;
    currentQuestionIndex = BASIC_QUESTIONS; // 6부터 3단계 질문 시작
    showScreen(screens.question);
    renderQuestion();
  });
}

function renderQuestion() {
  const isStage3 = currentQuestionIndex >= BASIC_QUESTIONS && selectedWorks.length > 0;
  const totalQuestions = BASIC_QUESTIONS + selectedWorks.length * QUESTIONS_PER_WORK;

  const stageBadge = $('stage-badge');
  if (stageBadge) {
    if (isStage3) {
      stageBadge.textContent = '3단계 · 작품 감상';
      stageBadge.className = 'stage-badge stage-3';
    } else if (currentQuestionIndex < 3) {
      stageBadge.textContent = '1단계 · 기본 규칙';
      stageBadge.className = 'stage-badge stage-1';
    } else {
      stageBadge.textContent = '2단계 · 암묵적 규칙';
      stageBadge.className = 'stage-badge stage-2';
    }
  }

  if (isStage3) {
    const workIdx = Math.floor((currentQuestionIndex - BASIC_QUESTIONS) / QUESTIONS_PER_WORK);
    const qInWork = (currentQuestionIndex - BASIC_QUESTIONS) % QUESTIONS_PER_WORK;
    const work = selectedWorks[workIdx];
    const workLabel = quizData.workLabels?.[work] || work;
    const wq = quizData.workQuestions[qInWork];
    const text = wq.text.replace('{work}', workLabel);

    $('progress-fill').style.width = `${((currentQuestionIndex + 1) / totalQuestions) * 100}%`;
    $('question-number').textContent = `Q_${String(currentQuestionIndex + 1).padStart(2, '0')} / ${String(totalQuestions).padStart(2, '0')}`;
    $('question-text').textContent = text;

    const optionsContainer = $('options');

    if (wq.usePrep) {
      optionsContainer.innerHTML = `
        <div class="work-prep">
          <button type="button" class="btn-prep-ready glitch-btn" id="btn-prep-ready"><span>준비완료</span></button>
        </div>
      `;
      $('btn-prep-ready')?.addEventListener('click', () => {
        currentQuestionIndex++;
        renderQuestion();
      });
      return;
    }

    if (wq.useSliders) {
      const work = selectedWorks[workIdx];
      const sliderConfig = (quizData.workSliders && quizData.workSliders[work]) || (quizData.workSliders && quizData.workSliders.A) || [
        { left: '편안함', right: '답답함', defaultVal: 50 },
        { left: '차분함', right: '혼란스러움', defaultVal: 50 },
        { left: '이상적', right: '현실적', defaultVal: 50 },
      ];
      const savedRaw = workSliderAnswers[workIdx];
      let saved = null;
      if (savedRaw && typeof savedRaw === 'object') {
        if (Array.isArray(savedRaw) && wq.key === 'far') saved = savedRaw;
        else if (!Array.isArray(savedRaw) && Array.isArray(savedRaw[wq.key])) saved = savedRaw[wq.key];
      }
      if (!saved || saved.length < 3) saved = sliderConfig.map(s => s.defaultVal);
      optionsContainer.innerHTML = `
        <div class="work-sliders">
          ${sliderConfig.map((slider, idx) => `
            <div class="slider-row">
              <span class="slider-label slider-left">${slider.left}</span>
              <input type="range" class="work-slider" min="0" max="100" value="${saved[idx]}" data-slider-idx="${idx}">
              <span class="slider-label slider-right">${slider.right}</span>
            </div>
            <div class="slider-value" data-value-idx="${idx}">${saved[idx]}%</div>
          `).join('')}
          <button type="button" class="btn-slider-next glitch-btn" id="btn-slider-next"><span>다음</span></button>
        </div>
      `;
      optionsContainer.querySelectorAll('.work-slider').forEach(input => {
        const valueEl = optionsContainer.querySelector(`[data-value-idx="${input.dataset.sliderIdx}"]`);
        input.addEventListener('input', () => { valueEl.textContent = input.value + '%'; });
      });
      $('btn-slider-next')?.addEventListener('click', () => {
        const vals = [];
        optionsContainer.querySelectorAll('.work-slider').forEach(inp => vals.push(parseInt(inp.value, 10)));
        const prev = workSliderAnswers[workIdx];
        const prevObj = prev && typeof prev === 'object'
          ? (Array.isArray(prev) ? { far: prev } : prev)
          : {};
        workSliderAnswers[workIdx] = { ...prevObj, [wq.key]: vals };
        currentQuestionIndex++;
        renderQuestion();
      });
      return;
    }

    if (wq.optionsKey === 'emotion') {
      const emotionOpts = quizData.workOptions.emotion;
      optionsContainer.innerHTML = `
        <div class="emotion-swipe-wrap" id="emotion-swipe-wrap">
          <div class="emotion-swipe-track">
            ${emotionOpts.map((opt, idx) => `
              <button type="button" class="emotion-swipe-item" data-value="${opt.value}" data-idx="${idx}">
                <span class="emotion-emoji">${opt.text}</span>
              </button>
            `).join('')}
          </div>
        </div>
        <p class="emotion-swipe-hint">좌우로 넘기고 이모지를 탭해 선택하세요</p>
      `;
      optionsContainer.querySelectorAll('.emotion-swipe-item').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const value = btn.dataset.value;
          optionsContainer.querySelectorAll('.emotion-swipe-item').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          answers[currentQuestionIndex] = value;
          const totalQuestions = BASIC_QUESTIONS + selectedWorks.length * QUESTIONS_PER_WORK;
          setTimeout(() => {
            optionsContainer.innerHTML = '';
            if (currentQuestionIndex < totalQuestions - 1) {
              currentQuestionIndex++;
              renderQuestion();
            } else {
              showResult();
            }
          }, 280);
        });
      });
      return;
    }

    const opts = quizData.workOptions[wq.optionsKey];
    optionsContainer.innerHTML = opts
      .map((opt, idx) => `
        <button type="button" class="option glitch-option option-wiggle option-wiggle-${(idx % 20) + 1}" data-value="${opt.value}">
          <span class="option-inner">${opt.text}</span>
        </button>
      `).join('');

    optionsContainer.querySelectorAll('.option').forEach(btn => {
      btn.addEventListener('click', handleOptionClick);
      btn.addEventListener('touchstart', () => {
        optionsContainer.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
        btn.classList.add('selected');
      }, { passive: true });
    });
    return;
  }

  const questions = (selectedMode && quizData.questionsByMode?.[selectedMode]) || quizData.questions;
  const question = questions[currentQuestionIndex];
  const total = questions.length;

  $('progress-fill').style.width = `${((currentQuestionIndex + 1) / total) * 100}%`;
  $('question-number').textContent = `Q_${String(currentQuestionIndex + 1).padStart(2, '0')} / ${String(total).padStart(2, '0')}`;
  $('question-text').textContent = question.text;

  const optionsContainer = $('options');
  optionsContainer.innerHTML = question.options
    .map((opt, idx) => `
      <button type="button" class="option glitch-option option-wiggle option-wiggle-${(idx % 20) + 1}" data-value="${opt.value}">
        <span class="option-inner">${opt.text}</span>
      </button>
    `).join('');

  optionsContainer.querySelectorAll('.option').forEach(btn => {
    btn.addEventListener('click', handleOptionClick);
    btn.addEventListener('touchstart', () => {
      optionsContainer.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
      btn.classList.add('selected');
    }, { passive: true });
  });
}

function handleOptionClick(e) {
  const btn = e.currentTarget;
  const optionsContainer = $('options');
  
  optionsContainer.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
  btn.classList.add('selected');
  answers[currentQuestionIndex] = btn.dataset.value;

  const isStage3 = currentQuestionIndex >= BASIC_QUESTIONS && selectedWorks.length > 0;
  const totalQuestions = BASIC_QUESTIONS + selectedWorks.length * QUESTIONS_PER_WORK;

  setTimeout(() => {
    optionsContainer.innerHTML = '';
    if (isStage3) {
      if (currentQuestionIndex < totalQuestions - 1) {
        currentQuestionIndex++;
        renderQuestion();
      } else {
        showResult();
      }
    } else {
      const questions = (selectedMode && quizData.questionsByMode?.[selectedMode]) || quizData.questions;
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
      } else {
  selectedWorks = [];
  workSliderAnswers = [];
  renderWorkSelect();
        showScreen(screens.workSelect);
      }
    }
  }, 280);
}

function sliderValuesToTypes() {
  const types = [];
  const defaultSliders = quizData.workSliders?.A || [
    { left: '편안함', right: '답답함', defaultVal: 50 },
    { left: '차분함', right: '혼란스러움', defaultVal: 50 },
    { left: '이상적', right: '현실적', defaultVal: 50 },
  ];
  workSliderAnswers.forEach((obj, i) => {
    if (!obj) return;
    const work = selectedWorks[i];
    const sliders = (quizData.workSliders && quizData.workSliders[work]) || defaultSliders;
    const o = Array.isArray(obj) ? { far: obj } : obj;
    const far = o.far;
    if (far && far.length >= 3 && sliders.length >= 3) {
      types.push(far[0] < 50 ? sliders[0].left : sliders[0].right);
      types.push(far[1] < 50 ? sliders[1].left : sliders[1].right);
      types.push(far[2] < 50 ? sliders[2].left : sliders[2].right);
    }
    const near = o.near;
    if (near && near.length >= 3 && sliders.length >= 3) {
      types.push(near[0] < 50 ? sliders[0].left : sliders[0].right);
      types.push(near[1] < 50 ? sliders[1].left : sliders[1].right);
      types.push(near[2] < 50 ? sliders[2].left : sliders[2].right);
    }
  });
  return types;
}

function showResult() {
  const counts = {};
  answers.forEach(v => counts[v] = (counts[v] || 0) + 1);
  sliderValuesToTypes().forEach(t => counts[t] = (counts[t] || 0) + 1);

  const allValues = [...answers, ...sliderValuesToTypes()].filter(Boolean);
  const maxCount = Math.max(...Object.values(counts), 0);
  const dominant = Object.entries(counts).find(([, c]) => c === maxCount)?.[0] || allValues[allValues.length - 1] || 'A';

  const result = quizData.results[dominant] || { type: dominant, description: `${dominant} 유형으로 분석되었습니다.` };
  $('result-type').textContent = result.type;
  setResultStar(result.type);
  
  const desc = result.description;
  
  $('result-description').innerHTML = desc.replace(/([.!?])\s+/g, '$1<br>');
  showScreen(screens.result);

  const othersEl = $('others-results');
  if (othersEl) othersEl.innerHTML = '';

  const hasSupabase = !!supabaseClient();
  saveResultToSupabase(result.type)
    .then(() => loadSimilarResults())
    .then((rows) => {
      const countByType = {};
      (rows || []).forEach((row) => {
        const t = row.result_type || '';
        if (t) countByType[t] = (countByType[t] || 0) + 1;
      });
      renderOthersResults(countByType, hasSupabase);
    })
    .catch((err) => {
      console.error('통계 로드 실패:', err);
      renderOthersResults({}, hasSupabase);
    });
}

const resetSettings = () => {
  currentQuestionIndex = 0;
  answers = [];
  selectedWork = null;
  selectedWorks = [];
  workSliderAnswers = [];
  selectedGender = null;
  selectedMode = null;
  $$('.setting-option').forEach(b => b.classList.remove('selected'));
  $$('.setting-gender').forEach(b => b.classList.remove('selected'));
  $$('.setting-mode').forEach(b => b.classList.remove('selected'));
  $('btn-confirm').disabled = true;
  showScreen(screens.settings);
  initStaticNoise();
};

function goToWorkReselect() {
  selectedWorks = [];
  workSliderAnswers = [];
  answers.length = BASIC_QUESTIONS;
  renderWorkSelect();
  showScreen(screens.workSelect);
}

const scheduleGlitch = () => {
  setTimeout(() => {
    const glitchScreen = $('glitch-screen');
    if (glitchScreen) {
      glitchScreen.classList.add('active');
      setTimeout(() => glitchScreen.classList.remove('active'), 150);
    }
    scheduleGlitch();
  }, 2000 + Math.random() * 5000);
};

function handleQuestionBack() {
  if (currentQuestionIndex === 0) {
    showScreen(screens.settings);
    return;
  }
  if (currentQuestionIndex === BASIC_QUESTIONS) {
    currentQuestionIndex = BASIC_QUESTIONS - 1;
    showScreen(screens.workSelect);
    renderWorkSelect();
    return;
  }
  currentQuestionIndex--;
  renderQuestion();
}

document.addEventListener('DOMContentLoaded', () => {
  setupSettingsScreen();
  scheduleGlitch();
  
  document.querySelector('.btn-start').addEventListener('click', resetSettings);
  $('btn-repick')?.addEventListener('click', goToWorkReselect);
  document.querySelector('.btn-retry')?.addEventListener('click', resetSettings);
  $('btn-question-back')?.addEventListener('click', handleQuestionBack);
});
